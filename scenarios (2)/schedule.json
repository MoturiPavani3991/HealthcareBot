{"id":"59d8d764-0b6f-46d1-a9e2-5127a0d9bd0b","name":"schedule","scenario_trigger":"schedule","description":"Scheduling appointment with docotr","active":true,"updated":"2019-02-05T14:36:14.7460000Z","userDisplayName":"Bhanu Kandregula","code":"{\"version\":3,\"steps\":[{\"id\":\"8201e16e9b4d-7ac7c92b6028bb54-c037\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":540,\"yLocation\":0,\"next\":\"45da079051e4-c6e3d656d490d498-b6fc\"},\"text\":\"Sure, please enter your full name.\",\"variable\":\"patientName\",\"stringId\":\"stringId_314658be365b095f\"},{\"id\":\"447d8cc9c654-dec2d16b6ad1919b-c15c\",\"type\":\"prompt\",\"dataType\":\"number\",\"designer\":{\"xLocation\":520,\"yLocation\":40,\"next\":\"de5c51b3e573-792308ef3461eeff-a2f5\"},\"text\":\"May I have your contact number please.\",\"variable\":\"patientContact\",\"maxRetries\":1,\"stringId\":\"stringId_e6b996f7cbf23f8e\"},{\"id\":\"ce1900ca393f-ddff5c24d23febc0-92a2\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":500,\"yLocation\":100,\"next\":\"ca86fcc0d98d-d39f144ceb544d7e-41c7\"},\"variable\":\"appointmentDate\",\"stringId\":\"stringId_b41aaf8e1d286677\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n\\t\\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n\\t\\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n\\t\\\"version\\\": \\\"1.0\\\",\\r\\n\\t\\\"body\\\": [\\r\\n        {\\r\\n\\t\\t\\t\\\"type\\\": \\\"TextBlock\\\",\\r\\n\\t\\t\\t\\\"text\\\": \\\"\\\"\\r\\n\\t\\t},\\r\\n\\t\\t{\\r\\n\\t\\t\\t\\\"type\\\": \\\"Input.Date\\\",\\r\\n\\t\\t\\t\\\"placeholder\\\": \\\"Due Date\\\",\\r\\n\\t\\t\\t\\\"id\\\": \\\"DateVal\\\"\\r\\n\\t\\t},\\r\\n        {\\r\\n\\t\\t\\t\\\"type\\\": \\\"Input.Time\\\",\\r\\n\\t\\t\\t\\\"placeholder\\\": \\\"Time\\\",\\r\\n\\t\\t\\t\\\"id\\\": \\\"TimeVal\\\"\\r\\n\\t\\t},\\r\\n        {\\r\\n\\t\\t\\t\\\"type\\\": \\\"Input.Text\\\",\\r\\n\\t\\t\\t\\\"id\\\": \\\"description\\\",\\r\\n\\t\\t\\t\\\"isMultiline\\\": true,\\r\\n\\t\\t\\t\\\"placeholder\\\": \\\"describe your reason\\\"\\r\\n\\t\\t}\\r\\n\\t],\\r\\n\\t\\\"actions\\\": [\\r\\n\\t\\t{\\r\\n\\t\\t\\t\\\"type\\\": \\\"Action.Submit\\\",\\r\\n\\t\\t\\t\\\"title\\\": \\\"Submit\\\",\\r\\n\\t\\t\\t\\\"data\\\": {\\r\\n\\t\\t\\t\\t\\\"id\\\": \\\"1234567890\\\"\\r\\n\\t\\t\\t}\\r\\n\\t\\t}\\r\\n\\t]\\r\\n}\"}],\"label\":\"appointmentDate\"},{\"id\":\"5a209a892f51-6e92eee4f415ed83-aa9b\",\"type\":\"prompt\",\"dataType\":\"[${confirmation}.slot1,${confirmation}.slot2]\",\"designer\":{\"xLocation\":431,\"yLocation\":331,\"listStyle\":3},\"text\":\"'I see the time slots are not available on '+JSON.parse(${appointmentDate}).DateVal+'. Below are the available time slots please choose from the following?'\\r\\n\",\"variable\":\"timeSlot\",\"maxRetries\":2,\"stringId\":\"stringId_00aff6adf8222974\"},{\"id\":\"799ab3ce782e-cda0262547c081fd-e563\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":220,\"yLocation\":100,\"next\":\"cc47fa02703b-f037150235fcb5c4-23e4\"},\"text\":\"Please enter your Insurance provider name.\",\"variable\":\"insuranceProvider\",\"stringId\":\"stringId_fcfbfc63c8f7c093\",\"layout\":\"vertical\"},{\"id\":\"1369b1ab1eaa-7597c998da3ed913-94f7\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":220,\"yLocation\":200,\"next\":\"2438802a5ae2-4b279fb6183e137d-7e98\"},\"variable\":\"groupId\",\"stringId\":\"stringId_48cead97d4b38cec\",\"layout\":\"vertical\",\"attachment\":[\"@{resourcesUrl} + \\\"/Miracle Health2.jpg\\\"\"]},{\"id\":\"23edf82d70ef-3fb20b5bf5fa8aa8-efad\",\"type\":\"statement\",\"designer\":{\"xLocation\":480,\"yLocation\":440},\"layout\":\"vertical\",\"attachment\":[{\"type\":\"Carousel\",\"carouselCode\":\"(function(){\\n    return [\\n        new builder.ThumbnailCard().title(${scenarioArgs}.doctorName).subtitle(${appointment}.specialization).\\n        text(\\\"Date : \\\"+${appointment}.date+\\\"\\\\n\\\" +\\\"Time : \\\"+ ${appointment}.finalTime+\\\"\\\\n\\\"+\\\"Address : \\\"+${appointment}.address).\\n        images([builder.CardImage.create(session,${appointment}.imgURL)])\\n    ] \\n    })()\\n\"}],\"stringId\":\"stringId_4f7dce0fa66d25d1\"},{\"id\":\"ca86fcc0d98d-d39f144ceb544d7e-41c7\",\"type\":\"datasource\",\"designer\":{\"xLocation\":510,\"yLocation\":189,\"next\":\"322f53cfc17d-b66316a7bae5c6b6-4af8\",\"errorStepId\":\"b8a5943ab501-962f1a0be9430319-d40c\"},\"dataConnection\":\"\",\"urlBase\":\"'https://healthcarev2.azurewebsites.net'\",\"urlPath\":\"'/slots'\",\"urlParams\":\"'slot='+JSON.parse(${appointmentDate}).TimeVal+'&date='+JSON.parse(${appointmentDate}).DateVal\",\"method\":\"get\",\"headers\":\"\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"confirmation\",\"error\":\"err\"},{\"id\":\"322f53cfc17d-b66316a7bae5c6b6-4af8\",\"type\":\"branch\",\"condition\":\"${confirmation}.msg\",\"designer\":{\"xLocation\":551,\"yLocation\":253,\"next\":\"5a209a892f51-6e92eee4f415ed83-aa9b\"},\"targetStepId\":\"3f83e1cd56fe-cc6307d9bb039cfa-58b0\"},{\"id\":\"5103b052a0a9-08ec457bc58a58f7-ae8e\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":193,\"yLocation\":300,\"next\":\"1f8460b54a4b-2de082b466a686d5-1625\"},\"variable\":\"insuranceID\",\"stringId\":\"stringId_fb16aa73693e82ce\",\"layout\":\"vertical\",\"attachment\":[\"@{resourcesUrl} + \\\"/Miracle Health.jpg\\\"\"]},{\"id\":\"1f8460b54a4b-2de082b466a686d5-1625\",\"type\":\"datasource\",\"designer\":{\"xLocation\":100,\"yLocation\":360,\"next\":\"d88a66b8a438-4458b18de479c432-e692\",\"errorStepId\":\"8f49e2264c78-bc59d029af3e8c61-e15a\"},\"dataConnection\":\"\",\"urlBase\":\"'https://healthcarev2.azurewebsites.net'\",\"urlPath\":\"'/sheduleAppointment'\",\"urlParams\":\"'doctorName='+${scenarioArgs}.doctorName+'&description='+JSON.parse(${appointmentDate}).description+'&phone='+${patientContact}+'&date='+JSON.parse(${appointmentDate}).DateVal+'&time='+JSON.parse(${appointmentDate}).TimeVal+'&patientName='+${patientName}+'&email='+${email}+'&insuranceProvider='+${insuranceProvider}+'&groupId='+${groupId}+'&insuranceID='+${insuranceID}\",\"method\":\"get\",\"headers\":\"\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"appointment\",\"error\":\"err\"},{\"id\":\"b8a5943ab501-962f1a0be9430319-d40c\",\"type\":\"statement\",\"designer\":{\"xLocation\":420,\"yLocation\":220},\"text\":\"'Please try after some time'+${err}+'.'\",\"stringId\":\"stringId_0b9eef4af4e03076\"},{\"id\":\"8f49e2264c78-bc59d029af3e8c61-e15a\",\"type\":\"statement\",\"designer\":{\"xLocation\":20,\"yLocation\":400},\"text\":\"'Please try after some time'+${err}\",\"stringId\":\"stringId_0b9eef4af4e03076\"},{\"id\":\"d88a66b8a438-4458b18de479c432-e692\",\"type\":\"branch\",\"condition\":\"${appointment}.status\",\"designer\":{\"xLocation\":300,\"yLocation\":340,\"next\":\"df812474bce7-5ba4edbff495a930-cd85\"},\"targetStepId\":\"5c491d3e9266-7d16b77aae7b3aac-efd4\"},{\"id\":\"df812474bce7-5ba4edbff495a930-cd85\",\"type\":\"statement\",\"designer\":{\"xLocation\":234,\"yLocation\":420},\"text\":\"'Something went wrong, appointment not booked. Please try again.'\",\"stringId\":\"stringId_09da45f685ead3ec\"},{\"id\":\"45da079051e4-c6e3d656d490d498-b6fc\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":660,\"yLocation\":20,\"next\":\"447d8cc9c654-dec2d16b6ad1919b-c15c\"},\"text\":\"Sure, please enter your email ID.\",\"variable\":\"email\",\"stringId\":\"stringId_74db0c98a114050a\"},{\"id\":\"5c491d3e9266-7d16b77aae7b3aac-efd4\",\"type\":\"statement\",\"designer\":{\"xLocation\":400,\"yLocation\":393,\"next\":\"23edf82d70ef-3fb20b5bf5fa8aa8-efad\"},\"text\":\"'Your appointment has been successfully scheduled with '+${scenarioArgs}.doctorName+' at '+${appointment}.date+'. Please find the location details here.'\\r\\n\",\"stringId\":\"stringId_4f7dce0fa66d25d1\"},{\"id\":\"3f83e1cd56fe-cc6307d9bb039cfa-58b0\",\"type\":\"datasource\",\"designer\":{\"xLocation\":220,\"yLocation\":20,\"next\":\"c7e567f754ef-16f4d8aed9308949-1748\",\"errorStepId\":\"b0a4f59ca735-50baf1b2898b8abe-6fd2\"},\"dataConnection\":\"\",\"urlBase\":\"'https://healthcarev2.azurewebsites.net'\",\"urlPath\":\"'/insuranceCheck'\",\"urlParams\":\"'email='+${email}\",\"method\":\"get\",\"headers\":\"\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"insuranceresp\",\"error\":\"err\"},{\"id\":\"c7e567f754ef-16f4d8aed9308949-1748\",\"type\":\"branch\",\"condition\":\"${insuranceresp}.status\",\"designer\":{\"xLocation\":60,\"yLocation\":80,\"next\":\"799ab3ce782e-cda0262547c081fd-e563\"},\"targetStepId\":\"99bb87b9f4e0-bf248e45d26e5091-da19\"},{\"id\":\"b0a4f59ca735-50baf1b2898b8abe-6fd2\",\"type\":\"statement\",\"designer\":{\"xLocation\":66,\"yLocation\":34},\"text\":\"'Server not responding. Please try after sometime.'\",\"stringId\":\"stringId_0952b2d376028a45\"},{\"id\":\"cc47fa02703b-f037150235fcb5c4-23e4\",\"type\":\"statement\",\"designer\":{\"xLocation\":220,\"yLocation\":154,\"next\":\"1369b1ab1eaa-7597c998da3ed913-94f7\"},\"text\":\"'Please enter your Group ID?'\",\"stringId\":\"stringId_48cead97d4b38cec\"},{\"id\":\"2438802a5ae2-4b279fb6183e137d-7e98\",\"type\":\"statement\",\"designer\":{\"xLocation\":220,\"yLocation\":252,\"next\":\"5103b052a0a9-08ec457bc58a58f7-ae8e\"},\"text\":\"'Please enter your '+${insuranceProvider}+' Member ID?'\",\"stringId\":\"stringId_fb16aa73693e82ce\"},{\"id\":\"de5c51b3e573-792308ef3461eeff-a2f5\",\"type\":\"statement\",\"designer\":{\"xLocation\":633,\"yLocation\":76,\"next\":\"ce1900ca393f-ddff5c24d23febc0-92a2\"},\"text\":\"\\\"On which date would you like to see \\\"+${scenarioArgs}.doctorName+\\\".\\\"\",\"stringId\":\"stringId_b41aaf8e1d286677\"},{\"id\":\"99bb87b9f4e0-bf248e45d26e5091-da19\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":73,\"yLocation\":186,\"next\":\"fdcea23adc7e-0e19634b98d52e5e-7641\"},\"text\":\"\\\"I see we found your Insurance details in our records. Please confirm\\\"\",\"variable\":\"insuranceconfirm\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"Carousel\",\"carouselCode\":\"(function(){\\n    return [\\n        new builder.ThumbnailCard().text(\\\"InsuranceProvider: \\\"+${insuranceresp}.insuranceProvider+\\\"\\\\n\\\"+'Insurance ID: '+${insuranceresp}.insuranceID +'\\\\n'+'Groud ID: '+${insuranceresp}.groupId).subtitle().\\n        buttons([\\n            builder.CardAction.postBack(session,'Yes','Yes'),\\n            builder.CardAction.postBack(session,'No','No') \\n        ])\\n    ] \\n    })()\\n\"}],\"stringId\":\"stringId_5a8e56add7135d24\"},{\"id\":\"fdcea23adc7e-0e19634b98d52e5e-7641\",\"type\":\"switch\",\"designer\":{\"xLocation\":48,\"yLocation\":240},\"cases\":[{\"value\":\"Yes\",\"targetStepId\":\"1f8460b54a4b-2de082b466a686d5-1625\"},{\"value\":\"No\",\"targetStepId\":\"799ab3ce782e-cda0262547c081fd-e563\"}],\"condition\":\"${insuranceconfirm}\"}],\"returningMessage\":\"\",\"interrupting\":false,\"breaking\":false}"}
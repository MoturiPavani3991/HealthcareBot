{"id":"9f2d496c-2c32-43b7-acc1-2e6b80d52172","name":"findingaDoc","scenario_trigger":"findingaDoc","description":"User selects the provider type to look for and search by location","active":true,"updated":"2019-02-05T16:16:57.8500000Z","userDisplayName":"Bhanu Kandregula","code":"{\"version\":2,\"steps\":[{\"id\":\"5d54a667ed51-5424faa596a98a51-a335\",\"type\":\"datasource\",\"designer\":{\"xLocation\":394,\"yLocation\":40,\"errorStepId\":\"c2e78289220b-f97154becdd03be9-284d\",\"next\":\"837e25ac5323-4e4008969b5bf804-f9fa\"},\"dataConnection\":\"\",\"urlBase\":\"'https://healthcarev2.azurewebsites.net'\",\"urlPath\":\"'/listSpecialization'\",\"urlParams\":\"\",\"method\":\"get\",\"headers\":\"\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"listSpecialization\",\"error\":\"err\"},{\"id\":\"837e25ac5323-4e4008969b5bf804-f9fa\",\"type\":\"statement\",\"designer\":{\"xLocation\":420,\"yLocation\":93,\"next\":\"7e7c8470ce75-5c6e3b262efe79d9-ba86\"},\"text\":\"'Are you interested in a specific specialty of the doctor? Please select from the list below:'\",\"stringId\":\"stringId_4c67ba850e2378b2\"},{\"id\":\"695d87603dbd-e563a89769ed22e4-9bd3\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":860,\"yLocation\":48},\"variable\":\"specialties\",\"stringId\":\"stringId_a55e1d1fff7cff22\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"\"}]},{\"id\":\"2f5c2f4a15cb-09c7a5f23e359662-191a\",\"type\":\"prompt\",\"dataType\":\"[\\\"No\\\",\\\"Female\\\",\\\"Male\\\"]\",\"designer\":{\"xLocation\":434,\"yLocation\":214,\"listStyle\":3,\"next\":\"cfd497913114-39e037cecd51d1dd-7361\"},\"text\":\"\\\"Do you have any gender preference?\\\"\",\"variable\":\"gender\",\"stringId\":\"stringId_3a0fdeaceacf85e1\"},{\"id\":\"5acaee3b9efb-8322543072e1d8c4-dbad\",\"type\":\"statement\",\"designer\":{\"xLocation\":433,\"yLocation\":429},\"text\":\"\\\"Server not responding. Please try after sometime.\\\"\",\"label\":\"Error handling\",\"stringId\":\"stringId_7f726cd178d669c8\"},{\"id\":\"7f375321d471-9a5124d1f8d2e22f-f54b\",\"type\":\"action\",\"label\":\"Create call parameters action\",\"designer\":{\"xLocation\":671,\"yLocation\":329,\"next\":\"663efd43bd6a-842b9424ea5c7192-eca2\"},\"onInit\":\"/*\\n * Use the following variable notation:\\n * \\n * ${var} = scenario local variables\\n * &{var} = user data variables\\n * @{var} = global conversation variables\\n * \\n * Available object to use in the code:\\n * require, session, moment, builder, next(), setTimeout, underscore\\n * \\n * Hit 'Ctrl + Space' for autocomplete\\n * \\n * Example: ${welcomeMessage} = \\\"Hello \\\" + ${name}\\n*/\\n\\nswitch(${gender}.entity) {\\n    case \\\"No\\\":\\n        ${doctorGender} = \\\"\\\";\\n        break;\\n    case \\\"Yes - Male\\\":\\n        ${doctorGender} = \\\"gender=Male\\\";\\n        break;\\n    default:\\n        ${doctorGender} = \\\"gender=Female\\\";\\n}\\n\\nswitch(${specialties}.entity) {\\n    case \\\"Cardiology\\\":\\n        ${doctorType} = \\\"cardiology\\\";\\n        break;\\n    case \\\"Dermatology\\\":\\n        ${doctorType} = \\\"dermatology\\\";\\n        break;\\n    case \\\"Neurology\\\":\\n        ${doctorType} = \\\"neurology\\\";\\n        break;\\n    default:\\n        ${doctorType} = \\\"cardiologist\\\";\\n}\\n\\n/*\\n* In order to use the user's current location as suggested below, you need to host the HealthBot Container\\n* and call chatRequested().\\n* Link to our github repository: https://github.com/Microsoft/HealthBotContainerSample\\n */\\n${mocked_location}=\\\"location=37.773%2C-122.413%2C100\\\";\\nswitch (${location_option}.entity) {\\n    case \\\"Current location\\\":\\n        ${user_location} = @{initConversationEvent} && @{initConversationEvent}.location\\n        ? \\\"location=\\\" +  @{initConversationEvent}.location.lat + \\\"%2C\\\" + @{initConversationEvent}.location.long +\\\"%2C100\\\"\\n        : ${mocked_location};\\n        break;\\n    default:\\n         ${user_location} = ${mocked_location};\\n}\\n\"},{\"id\":\"cfd497913114-39e037cecd51d1dd-7361\",\"type\":\"prompt\",\"dataType\":\"[\\\"Current location\\\",\\\"ZIP code/State/City\\\"]\",\"designer\":{\"xLocation\":430,\"yLocation\":280,\"listStyle\":3,\"next\":\"1dcef15d1fbb-58ea976331035140-a3f0\"},\"text\":\"Got it! I will be happy to assist. Should I use your current location or would you like to specify a ZIP code/State/City?\",\"variable\":\"location_option\",\"stringId\":\"stringId_f9b71f34617f8ffa\"},{\"id\":\"bcca11b7999c-4f437f4bca5dee54-d4a6\",\"type\":\"branch\",\"condition\":\"${doctors}.length !== 0\\r\\n\",\"designer\":{\"xLocation\":553,\"yLocation\":431,\"next\":\"8e1bd5dc1861-395f4143d4549e6a-2635\"},\"targetStepId\":\"48bcfb5daadb-02006655aebdcc4d-9cd1\"},{\"id\":\"8e1bd5dc1861-395f4143d4549e6a-2635\",\"type\":\"statement\",\"designer\":{\"xLocation\":470,\"yLocation\":540},\"text\":\"No doctors were found that meet all criteria.\",\"stringId\":\"stringId_3dbb98f559a4323a\"},{\"id\":\"cf887de9e443-d47a25d4ea0d4902-328a\",\"type\":\"statement\",\"designer\":{\"xLocation\":580,\"yLocation\":200,\"next\":\"7f375321d471-9a5124d1f8d2e22f-f54b\"},\"text\":\"Developer notice!\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n\\t\\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n\\t\\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n\\t\\\"version\\\": \\\"1.0\\\",\\r\\n\\t\\\"body\\\": [\\r\\n\\t\\t{\\r\\n\\t\\t\\t\\\"type\\\": \\\"Container\\\",\\r\\n\\t\\t\\t\\\"items\\\": [\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"TextBlock\\\",\\r\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"Turn on end-user active location\\\",\\r\\n\\t\\t\\t\\t\\t\\\"weight\\\": \\\"bolder\\\",\\r\\n\\t\\t\\t\\t\\t\\\"size\\\": \\\"medium\\\"\\r\\n                }\\r\\n\\t\\t\\t]\\r\\n\\t\\t},\\r\\n\\t\\t{\\r\\n\\t\\t\\t\\\"type\\\": \\\"Container\\\",\\r\\n\\t\\t\\t\\\"items\\\": [\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"TextBlock\\\",\\r\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"This scenario currently uses a static fixed location for provider lookup, you can turn on end-user active location option only after embedding the health bot instance within your application.\\\",\\r\\n\\t\\t\\t\\t\\t\\\"wrap\\\": true\\r\\n\\t\\t\\t\\t},\\r\\n                {\\r\\n                    \\\"type\\\": \\\"TextBlock\\\",\\r\\n                    \\\"wrap\\\": true,\\r\\n                    \\\"text\\\": \\\"[Embed a health bot instance in your application](https://docs.microsoft.com/en-us/healthbot/integrations/embed)\\\"\\r\\n                },\\r\\n                {\\r\\n                    \\\"type\\\": \\\"TextBlock\\\",\\r\\n                    \\\"wrap\\\": true,\\r\\n                    \\\"text\\\": \\\"[Sending user location while in chat](https://docs.microsoft.com/en-us/healthbot/integrations/embed)\\\"\\r\\n                }\\r\\n\\t\\t\\t]\\r\\n\\t\\t}\\r\\n\\t]\\r\\n}\"},{\"type\":\"HeroCard\",\"image\":\"@{resourcesUrl} + \\\"/doctor-character-background_1270-84.jpg\\\"\"}],\"label\":\"Developer notice\",\"stringId\":\"stringId_5770680de9fcb351\"},{\"id\":\"af530ebc0fd1-d4589ef406bd6367-2744\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":720,\"yLocation\":200,\"next\":\"7f375321d471-9a5124d1f8d2e22f-f54b\"},\"text\":\"Please enter a ZIP code/City/State.\",\"variable\":\"zip\",\"stringId\":\"stringId_cf14ebd73bfaddbb\"},{\"id\":\"1dcef15d1fbb-58ea976331035140-a3f0\",\"type\":\"branch\",\"condition\":\"${location_option}.entity === \\\"ZIP code/State/City\\\"\",\"designer\":{\"xLocation\":666,\"yLocation\":70,\"next\":\"cf887de9e443-d47a25d4ea0d4902-328a\"},\"targetStepId\":\"af530ebc0fd1-d4589ef406bd6367-2744\"},{\"id\":\"ea2dd2b794b4-41ddcd7250048dee-0931\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":860,\"yLocation\":100},\"variable\":\"doctorName\",\"layout\":\"carousel\",\"attachment\":[{\"type\":\"Carousel\",\"carouselCode\":\"(function(){\\n    var doctors = [];\\n    for (var i =0 ; i < ${doctors}.length; i++) {\\n        doctors.push(new builder.ThumbnailCard().title(${doctors}[i].doctorName).subtitle(${doctors}[i].specialization+\\\"\\\\n\\\"+${doctors}[i].mobile).\\n        text(${doctors}[i].location +\\\"\\\\n\\\" + ${doctors}[i].address1).\\n        images([builder.CardImage.create(session,${doctors}[i].imageURL)])\\n        // .\\n        // buttons([\\n        //     builder.CardAction.postBack(session,${doctors}[i].doctorName,'Schedule an appointment'),\\n        //     builder.CardAction.postBack(session,'call','Call +1 (512) 2345677') \\n        // ])\\n         );\\n    }\\n    return doctors;\\n    })()\\n\"}],\"label\":\"SelectDoctor\",\"text\":\"\\\"Here are the list of doctors available.\\\"\",\"stringId\":\"stringId_9abac132e55a84fe\"},{\"id\":\"2e708bece96b-36cc9a3ff29582fe-ee77\",\"type\":\"beginScenario\",\"designer\":{\"xLocation\":869,\"yLocation\":160},\"scenario\":\"schedule\",\"args\":\"{\\r\\n    'doctorName': ${doctorName},\\r\\n    'doctorType':${doctor_type},\\r\\n    'gender': ${gender},\\r\\n    'specialization':${specialties},\\r\\n    'zip':${zip}\\r\\n}\",\"variable\":\"doctorData\"},{\"id\":\"663efd43bd6a-842b9424ea5c7192-eca2\",\"type\":\"datasource\",\"designer\":{\"xLocation\":540,\"yLocation\":360,\"errorStepId\":\"5acaee3b9efb-8322543072e1d8c4-dbad\",\"next\":\"bcca11b7999c-4f437f4bca5dee54-d4a6\"},\"dataConnection\":\"\",\"urlBase\":\"'https://healthcarev2.azurewebsites.net'\",\"urlPath\":\"'/findDoctor'\",\"urlParams\":\"'specialization='+JSON.parse(${specialties}).speciality+'&Gender='+${gender}.entity+'&zipcode='+${zip}\",\"method\":\"get\",\"headers\":\"\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"doctors\",\"error\":\"err\"},{\"id\":\"8e5557e49a29-573330f4797dc06e-0a88\",\"type\":\"statement\",\"designer\":{\"xLocation\":640,\"yLocation\":540,\"next\":\"3c6e56b14210-01c7cb1422f1eaff-0f90\"},\"layout\":\"carousel\",\"attachment\":[{\"type\":\"Carousel\",\"carouselCode\":\"(function(){\\n    var doctors = [];\\n    for (var i =0 ; i < ${doctors}.length; i++) {\\n        doctors.push(new builder.ThumbnailCard().title(${doctors}[i].doctorName).subtitle(${doctors}[i].specialization+\\\"\\\\n\\\"+${doctors}[i].mobile).\\n        text(${doctors}[i].location +\\\"\\\\n\\\" + ${doctors}[i].address1).\\n        images([builder.CardImage.create(session,${doctors}[i].imageURL)])\\n        // .\\n        // buttons([\\n        //     builder.CardAction.postBack(session,${doctors}[i].doctorName,'Schedule an appointment'),\\n        //     builder.CardAction.postBack(session,'call','Call +1 (512) 2345677') \\n        // ])\\n         );\\n    }\\n    return doctors;\\n    })()\\n\"}],\"stringId\":\"stringId_9abac132e55a84fe\"},{\"id\":\"48bcfb5daadb-02006655aebdcc4d-9cd1\",\"type\":\"statement\",\"designer\":{\"xLocation\":640,\"yLocation\":493,\"next\":\"8e5557e49a29-573330f4797dc06e-0a88\"},\"text\":\"\\\"Here are the list of doctors available.\\\"\",\"stringId\":\"stringId_9abac132e55a84fe\"},{\"id\":\"7e7c8470ce75-5c6e3b262efe79d9-ba86\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":434,\"yLocation\":150,\"next\":\"2f5c2f4a15cb-09c7a5f23e359662-191a\"},\"text\":\"\\\"\\\"\",\"variable\":\"specialties\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n\\t\\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n\\t\\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n\\t\\\"version\\\": \\\"1.0\\\",\\r\\n\\t\\\"body\\\": [\\r\\n\\t\\t{\\r\\n      \\\"type\\\": \\\"Input.ChoiceSet\\\",\\r\\n      \\\"id\\\": \\\"speciality\\\",\\r\\n      \\\"style\\\": \\\"compact\\\",\\r\\n      \\\"isMultiSelect\\\": false,\\r\\n      \\\"value\\\": ${listSpecialization}[0].title,\\r\\n      \\\"choices\\\": ${listSpecialization}\\r\\n    }\\r\\n\\t],\\r\\n\\t\\\"actions\\\": [\\r\\n\\t\\t{\\r\\n      \\\"type\\\": \\\"Action.Submit\\\",\\r\\n      \\\"title\\\": \\\"Submit\\\"\\r\\n    }\\r\\n\\t]\\r\\n}\"}],\"stringId\":\"stringId_fcc3d7489d15ef49\"},{\"id\":\"c2e78289220b-f97154becdd03be9-284d\",\"type\":\"statement\",\"designer\":{\"xLocation\":300,\"yLocation\":126},\"text\":\"\\\"Server not responding, Please try after sometime.\\\"\",\"label\":\"Error handling\",\"stringId\":\"stringId_7f726cd178d669c8\"},{\"id\":\"3c6e56b14210-01c7cb1422f1eaff-0f90\",\"type\":\"datasource\",\"designer\":{\"xLocation\":640,\"yLocation\":593,\"errorStepId\":\"5acaee3b9efb-8322543072e1d8c4-dbad\",\"next\":\"5d982bab6d18-1ffb93b555ee2e1b-5c90\"},\"dataConnection\":\"\",\"urlBase\":\"'https://healthcarev2.azurewebsites.net'\",\"urlPath\":\"'/listDoctorsFromZipcodes'\",\"urlParams\":\"'specialization='+JSON.parse(${specialties}).speciality+'&Gender='+${gender}.entity+'&zipcode='+${zip}\",\"method\":\"get\",\"headers\":\"\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"doctors\",\"error\":\"err\"},{\"id\":\"5d982bab6d18-1ffb93b555ee2e1b-5c90\",\"type\":\"branch\",\"condition\":\"${doctors}.length !== 0\\r\\n\",\"designer\":{\"xLocation\":807,\"yLocation\":400},\"targetStepId\":\"cf820e195f02-f36ea3a86817689e-8e8c\"},{\"id\":\"cf820e195f02-f36ea3a86817689e-8e8c\",\"type\":\"statement\",\"designer\":{\"xLocation\":840,\"yLocation\":500,\"next\":\"f1f161edf2fe-573497c188e4395f-06c5\"},\"text\":\"\\\"Here are the few more doctors nearby locations.\\\"\",\"stringId\":\"stringId_9abac132e55a84fe\"},{\"id\":\"f1f161edf2fe-573497c188e4395f-06c5\",\"type\":\"statement\",\"designer\":{\"xLocation\":840,\"yLocation\":560},\"layout\":\"carousel\",\"attachment\":[{\"type\":\"Carousel\",\"carouselCode\":\"(function(){\\n    var doctors = [];\\n    for (var i =0 ; i < ${doctors}.length; i++) {\\n        doctors.push(new builder.ThumbnailCard().title(${doctors}[i].doctorName).subtitle(${doctors}[i].specialization+\\\"\\\\n\\\"+${doctors}[i].mobile).\\n        text(${doctors}[i].location +\\\"\\\\n\\\" + ${doctors}[i].address1+\\\"\\\\n\\\"+\\\"(\\\"+${doctors}[i].distance+\\\".0mi)\\\").\\n        images([builder.CardImage.create(session,${doctors}[i].imageURL)])\\n        // .\\n        // buttons([\\n        //     builder.CardAction.postBack(session,${doctors}[i].doctorName,'Schedule an appointment'),\\n        //     builder.CardAction.postBack(session,'call','Call +1 (512) 2345677') \\n        // ])\\n         );\\n    }\\n    return doctors;\\n    })()\\n\"}],\"stringId\":\"stringId_9abac132e55a84fe\"}],\"returningMessage\":\"\",\"interrupting\":false,\"breaking\":false}"}
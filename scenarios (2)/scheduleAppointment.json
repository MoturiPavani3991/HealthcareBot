{"id":"303b52d1-2b65-4ab1-8136-5e1c789c8992","name":"scheduleAppointment","scenario_trigger":"scheduleAppointment","description":"directly quering to schedule appointment","active":true,"updated":"2019-02-12T13:46:27.3450000Z","userDisplayName":"Bhanu Kandregula","code":"{\"version\":2,\"steps\":[{\"id\":\"0d5108f1445a-0523c32c6efbe9dc-386d\",\"type\":\"datasource\",\"designer\":{\"xLocation\":360,\"yLocation\":20,\"errorStepId\":\"eaa171843e6b-692b5a17efdef663-449d\",\"next\":\"621033957109-9146b4a29e4d1ece-e407\"},\"dataConnection\":\"\",\"urlBase\":\"'https://healthcarev2.azurewebsites.net'\",\"urlPath\":\"'/listSpecialization'\",\"urlParams\":\"\",\"method\":\"get\",\"headers\":\"\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"listSpecialization\",\"error\":\"err\"},{\"id\":\"695d87603dbd-e563a89769ed22e4-9bd3\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":371,\"yLocation\":140,\"next\":\"2f5c2f4a15cb-09c7a5f23e359662-191a\"},\"text\":\"''\",\"variable\":\"specialties\",\"stringId\":\"stringId_a55e1d1fff7cff22\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n\\t\\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n\\t\\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n\\t\\\"version\\\": \\\"1.0\\\",\\r\\n\\t\\\"body\\\": [\\r\\n\\t\\t{\\r\\n      \\\"type\\\": \\\"Input.ChoiceSet\\\",\\r\\n      \\\"id\\\": \\\"speciality\\\",\\r\\n      \\\"style\\\": \\\"compact\\\",\\r\\n      \\\"isMultiSelect\\\": false,\\r\\n      \\\"value\\\": ${listSpecialization}[0].title,\\r\\n      \\\"choices\\\": ${listSpecialization}\\r\\n    }\\r\\n\\t],\\r\\n\\t\\\"actions\\\": [\\r\\n\\t\\t{\\r\\n      \\\"type\\\": \\\"Action.Submit\\\",\\r\\n      \\\"title\\\": \\\"Submit\\\"\\r\\n    }\\r\\n\\t]\\r\\n}\"}]},{\"id\":\"2f5c2f4a15cb-09c7a5f23e359662-191a\",\"type\":\"prompt\",\"dataType\":\"[\\\"No\\\",\\\"Female\\\",\\\"Male\\\"]\",\"designer\":{\"xLocation\":331,\"yLocation\":220,\"listStyle\":3,\"next\":\"cfd497913114-39e037cecd51d1dd-7361\"},\"text\":\"Do you have any gender preference?\",\"variable\":\"gender\",\"stringId\":\"stringId_3a0fdeaceacf85e1\"},{\"id\":\"5acaee3b9efb-8322543072e1d8c4-dbad\",\"type\":\"statement\",\"designer\":{\"xLocation\":451,\"yLocation\":580},\"text\":\"JSON.stringify(${err});\",\"label\":\"Error handling\",\"stringId\":\"stringId_7f726cd178d669c8\"},{\"id\":\"7f375321d471-9a5124d1f8d2e22f-f54b\",\"type\":\"action\",\"label\":\"Create call parameters action\",\"designer\":{\"xLocation\":466,\"yLocation\":449,\"next\":\"3605c3075024-fbf2663af93f6ca9-bd74\"},\"onInit\":\"/*\\n * Use the following variable notation:\\n * \\n * ${var} = scenario local variables\\n * &{var} = user data variables\\n * @{var} = global conversation variables\\n * \\n * Available object to use in the code:\\n * require, session, moment, builder, next(), setTimeout, underscore\\n * \\n * Hit 'Ctrl + Space' for autocomplete\\n * \\n * Example: ${welcomeMessage} = \\\"Hello \\\" + ${name}\\n*/\\n\\nswitch(${gender}.entity) {\\n    case \\\"No\\\":\\n        ${doctorGender} = \\\"\\\";\\n        break;\\n    case \\\"Yes - Male\\\":\\n        ${doctorGender} = \\\"gender=Male\\\";\\n        break;\\n    default:\\n        ${doctorGender} = \\\"gender=Female\\\";\\n}\\n\\nswitch(${specialties}.entity) {\\n    case \\\"Cardiology\\\":\\n        ${doctorType} = \\\"cardiology\\\";\\n        break;\\n    case \\\"Dermatology\\\":\\n        ${doctorType} = \\\"dermatology\\\";\\n        break;\\n    case \\\"Neurology\\\":\\n        ${doctorType} = \\\"neurology\\\";\\n        break;\\n    default:\\n        ${doctorType} = \\\"cardiologist\\\";\\n}\\n\\n/*\\n* In order to use the user's current location as suggested below, you need to host the HealthBot Container\\n* and call chatRequested().\\n* Link to our github repository: https://github.com/Microsoft/HealthBotContainerSample\\n */\\n${mocked_location}=\\\"location=37.773%2C-122.413%2C100\\\";\\nswitch (${location_option}.entity) {\\n    case \\\"Current location\\\":\\n        ${user_location} = @{initConversationEvent} && @{initConversationEvent}.location\\n        ? \\\"location=\\\" +  @{initConversationEvent}.location.lat + \\\"%2C\\\" + @{initConversationEvent}.location.long +\\\"%2C100\\\"\\n        : ${mocked_location};\\n        break;\\n    default:\\n         ${user_location} = ${mocked_location};\\n}\\n\\nvar msg = new builder.Message(session);\\nmsg.data.type = \\\"event\\\";\\nmsg.data.name = \\\"shareLocation\\\";\\nmsg.data.value = ${user_location};\\nsession.send(msg);\"},{\"id\":\"cfd497913114-39e037cecd51d1dd-7361\",\"type\":\"prompt\",\"dataType\":\"[\\\"Current location\\\",\\\"ZIP code/City/State\\\"]\",\"designer\":{\"xLocation\":280,\"yLocation\":308,\"listStyle\":3,\"next\":\"1dcef15d1fbb-58ea976331035140-a3f0\"},\"text\":\"\\\"Got it! I will be happy to assist. Should I use your current location or would you like to specify a ZIP code/City/State?\\\"\",\"variable\":\"location_option\",\"stringId\":\"stringId_f9b71f34617f8ffa\"},{\"id\":\"bcca11b7999c-4f437f4bca5dee54-d4a6\",\"type\":\"branch\",\"condition\":\"${doctors}.length !== 0\\r\\n\",\"designer\":{\"xLocation\":571,\"yLocation\":608,\"next\":\"8e1bd5dc1861-395f4143d4549e6a-2635\"},\"targetStepId\":\"da0bb3bf4840-cb80d0457a3fc437-6e97\"},{\"id\":\"8e1bd5dc1861-395f4143d4549e6a-2635\",\"type\":\"statement\",\"designer\":{\"xLocation\":451,\"yLocation\":708},\"text\":\"No doctors were found that meet all criteria.\",\"stringId\":\"stringId_3dbb98f559a4323a\"},{\"id\":\"cf887de9e443-d47a25d4ea0d4902-328a\",\"type\":\"statement\",\"designer\":{\"xLocation\":331,\"yLocation\":368,\"next\":\"7f375321d471-9a5124d1f8d2e22f-f54b\"},\"text\":\"Developer notice!\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n\\t\\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n\\t\\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n\\t\\\"version\\\": \\\"1.0\\\",\\r\\n\\t\\\"body\\\": [\\r\\n\\t\\t{\\r\\n\\t\\t\\t\\\"type\\\": \\\"Container\\\",\\r\\n\\t\\t\\t\\\"items\\\": [\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"TextBlock\\\",\\r\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"Turn on end-user active location\\\",\\r\\n\\t\\t\\t\\t\\t\\\"weight\\\": \\\"bolder\\\",\\r\\n\\t\\t\\t\\t\\t\\\"size\\\": \\\"medium\\\"\\r\\n                }\\r\\n\\t\\t\\t]\\r\\n\\t\\t},\\r\\n\\t\\t{\\r\\n\\t\\t\\t\\\"type\\\": \\\"Container\\\",\\r\\n\\t\\t\\t\\\"items\\\": [\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"TextBlock\\\",\\r\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"This scenario currently uses a static fixed location for provider lookup, you can turn on end-user active location option only after embedding the health bot instance within your application.\\\",\\r\\n\\t\\t\\t\\t\\t\\\"wrap\\\": true\\r\\n\\t\\t\\t\\t},\\r\\n                {\\r\\n                    \\\"type\\\": \\\"TextBlock\\\",\\r\\n                    \\\"wrap\\\": true,\\r\\n                    \\\"text\\\": \\\"[Embed a health bot instance in your application](https://docs.microsoft.com/en-us/healthbot/integrations/embed)\\\"\\r\\n                },\\r\\n                {\\r\\n                    \\\"type\\\": \\\"TextBlock\\\",\\r\\n                    \\\"wrap\\\": true,\\r\\n                    \\\"text\\\": \\\"[Sending user location while in chat](https://docs.microsoft.com/en-us/healthbot/integrations/embed)\\\"\\r\\n                }\\r\\n\\t\\t\\t]\\r\\n\\t\\t}\\r\\n\\t]\\r\\n}\"},{\"type\":\"HeroCard\",\"image\":\"@{resourcesUrl} + \\\"/doctor-character-background_1270-84.jpg\\\"\"}],\"label\":\"Developer notice\",\"stringId\":\"stringId_5770680de9fcb351\"},{\"id\":\"af530ebc0fd1-d4589ef406bd6367-2744\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":451,\"yLocation\":368,\"next\":\"7f375321d471-9a5124d1f8d2e22f-f54b\"},\"text\":\"\\\"Please enter a ZIP code/City/State.\\\"\",\"variable\":\"zip\",\"stringId\":\"stringId_cf14ebd73bfaddbb\"},{\"id\":\"1dcef15d1fbb-58ea976331035140-a3f0\",\"type\":\"branch\",\"condition\":\"${location_option}.entity === \\\"ZIP code/City/State\\\"\",\"designer\":{\"xLocation\":431,\"yLocation\":280,\"next\":\"cf887de9e443-d47a25d4ea0d4902-328a\"},\"targetStepId\":\"af530ebc0fd1-d4589ef406bd6367-2744\"},{\"id\":\"ea2dd2b794b4-41ddcd7250048dee-0931\",\"type\":\"prompt\",\"dataType\":\"string\",\"designer\":{\"xLocation\":731,\"yLocation\":740,\"next\":\"2e708bece96b-36cc9a3ff29582fe-ee77\"},\"variable\":\"doctorName\",\"layout\":\"carousel\",\"attachment\":[{\"type\":\"Carousel\",\"carouselCode\":\"(function(){\\n    var doctors = [];\\n    for (var i =0 ; i < ${doctors}.length; i++) {\\n        doctors.push(new builder.ThumbnailCard().title(${doctors}[i].doctorName).subtitle(${doctors}[i].specialization).\\n        text(${doctors}[i].location +\\\"\\\\n\\\" + ${doctors}[i].address1).\\n        images([builder.CardImage.create(session,${doctors}[i].imageURL)]).\\n        buttons([\\n            builder.CardAction.postBack(session,${doctors}[i].doctorName,'Schedule an appointment'),\\n            builder.CardAction.postBack(session,'call','Call +1 (512) 2345677') \\n        ]));\\n    }\\n    return doctors;\\n    })()\\n\"}],\"label\":\"SelectDoctor\"},{\"id\":\"2e708bece96b-36cc9a3ff29582fe-ee77\",\"type\":\"beginScenario\",\"designer\":{\"xLocation\":740,\"yLocation\":800},\"scenario\":\"schedule\",\"args\":\"{\\r\\n    'doctorName': ${doctorName},\\r\\n    'doctorType':${doctor_type},\\r\\n    'gender': ${gender},\\r\\n    'specialization':${specialties},\\r\\n    'zip':${zip}\\r\\n}\",\"variable\":\"doctorData\"},{\"id\":\"663efd43bd6a-842b9424ea5c7192-eca2\",\"type\":\"datasource\",\"designer\":{\"xLocation\":571,\"yLocation\":520,\"errorStepId\":\"5acaee3b9efb-8322543072e1d8c4-dbad\",\"next\":\"bcca11b7999c-4f437f4bca5dee54-d4a6\"},\"dataConnection\":\"\",\"urlBase\":\"'https://healthcarev2.azurewebsites.net'\",\"urlPath\":\"'/findDoctor'\",\"urlParams\":\"'specialization='+JSON.parse(${specialties}).speciality+'&Gender='+${gender}.entity+'&zipcode='+${zip}\",\"method\":\"get\",\"headers\":\"\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"doctors\",\"error\":\"err\"},{\"id\":\"da0bb3bf4840-cb80d0457a3fc437-6e97\",\"type\":\"statement\",\"designer\":{\"xLocation\":711,\"yLocation\":680,\"next\":\"ea2dd2b794b4-41ddcd7250048dee-0931\"},\"text\":\"\\\"Here are the list of doctors available.\\\"\",\"stringId\":\"stringId_1d54221b37bb0e32\"},{\"id\":\"621033957109-9146b4a29e4d1ece-e407\",\"type\":\"statement\",\"designer\":{\"xLocation\":360,\"yLocation\":80,\"next\":\"695d87603dbd-e563a89769ed22e4-9bd3\"},\"text\":\"\\\"Are you interested in a specific specialty of the doctor? Please select from the list below:\\\"\",\"stringId\":\"stringId_33bf2ef437d8d1ea\"},{\"id\":\"eaa171843e6b-692b5a17efdef663-449d\",\"type\":\"statement\",\"designer\":{\"xLocation\":253,\"yLocation\":80},\"text\":\"\\\"Server not responding, Please try again.\\\"\",\"stringId\":\"stringId_7f726cd178d669c8\"},{\"id\":\"e18540f5668a-4d52940ace0e5715-2191\",\"type\":\"statement\",\"designer\":{\"xLocation\":820,\"yLocation\":647},\"text\":\"${doctorName}\",\"stringId\":\"stringId_67649b4fb0a3d351\"},{\"id\":\"3605c3075024-fbf2663af93f6ca9-bd74\",\"type\":\"statement\",\"designer\":{\"xLocation\":553,\"yLocation\":256,\"next\":\"663efd43bd6a-842b9424ea5c7192-eca2\"},\"text\":\"${location}\",\"stringId\":\"stringId_3a4d34163b60ac49\"},{\"id\":\"5433e997cb84-9844a9b6d4696443-6bb5\",\"type\":\"prompt\",\"dataType\":\"attachment\",\"designer\":{\"xLocation\":69,\"yLocation\":56},\"text\":\"upload an image\",\"variable\":\"healthcard\",\"maxRetries\":1,\"stringId\":\"stringId_40e60a289cbeb24e\"},{\"id\":\"04fc54ff02ae-1f5a3eeb9acb4e4a-8492\",\"type\":\"statement\",\"designer\":{\"xLocation\":113,\"yLocation\":136},\"text\":\"${healthcard}\",\"stringId\":\"stringId_181e9e8e82e4b761\"}],\"returningMessage\":\"\",\"interrupting\":false,\"breaking\":false}"}
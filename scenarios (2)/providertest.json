{"id":"8e8cc096-3f2c-425e-92d6-2eb0b5b631bd","name":"providertest","scenario_trigger":"providertest","description":"User selects the provider type to look for and search by location","active":true,"updated":"2019-01-25T15:11:54.3440000Z","userDisplayName":"Bhanu Kandregula","code":"{\"version\":2,\"steps\":[{\"id\":\"933175e9d6e9-759544d3aab92243-58ba\",\"type\":\"yesnoprompt\",\"dataType\":\"boolean\",\"designer\":{\"xLocation\":120,\"yLocation\":14,\"next\":\"032401b8bdc3-2601489f61bd5be4-e6a1\"},\"text\":\"May I help you find a Contoso provider?\",\"variable\":\"res\",\"targetStepId\":\"17980ff39aed-a7a0b09798ec56ed-4b1f\",\"stringId\":\"stringId_d06bee4197413bda\"},{\"id\":\"9b6374f51806-7008b402e962d220-ff93\",\"type\":\"datasource\",\"designer\":{\"xLocation\":374,\"yLocation\":320,\"errorStepId\":\"5acaee3b9efb-8322543072e1d8c4-dbad\",\"next\":\"bcca11b7999c-4f437f4bca5dee54-d4a6\"},\"dataConnection\":\"\",\"urlBase\":\"https://scenariocatalogprod.azurewebsites.net\",\"urlPath\":\"/providerLookup\",\"urlParams\":\"${user_location} + '&tk=83cf6c2a-397e-4626-9b71-1f956e551939&' + ${doctorGender} + '&specialty_uid=' + ${doctorType}\",\"method\":\"get\",\"headers\":\"\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"doctors\",\"error\":\"err\",\"label\":\"Provider lookup data connection call\"},{\"id\":\"032401b8bdc3-2601489f61bd5be4-e6a1\",\"type\":\"statement\",\"designer\":{\"xLocation\":32,\"yLocation\":80},\"text\":\"If you have any further questions, please donâ€™t hesitate to contact me.\",\"stringId\":\"stringId_fd5799163fff07b0\"},{\"id\":\"17980ff39aed-a7a0b09798ec56ed-4b1f\",\"type\":\"prompt\",\"dataType\":[\"Doctor\",\"Dentist\",\"Hospital\"],\"designer\":{\"xLocation\":190,\"yLocation\":80,\"listStyle\":3,\"next\":\"6eb38059e0f4-354d4b1c3331bfed-9eb5\"},\"text\":\"What type of provider do you look for?\",\"variable\":\"doctor_type\",\"layout\":\"vertical\",\"stringId\":\"stringId_61493fb14a96ce39\"},{\"id\":\"695d87603dbd-e563a89769ed22e4-9bd3\",\"type\":\"prompt\",\"dataType\":[\"Cardiology\",\"Dermatology\",\"Endocrinology\",\"Family Physicians\",\"Gastroenterology\",\"Hematology\",\"Neurology\",\"Oncology\",\"Pediatrician\",\"Psychiatrist\",\"General Surgeon\",\"Urology\"],\"designer\":{\"xLocation\":386,\"yLocation\":20,\"listStyle\":2,\"next\":\"2f5c2f4a15cb-09c7a5f23e359662-191a\"},\"text\":\"Are you interested in a specific specialty of the doctor? Please select from the list below:\",\"variable\":\"specialties\",\"stringId\":\"stringId_a55e1d1fff7cff22\"},{\"id\":\"2f5c2f4a15cb-09c7a5f23e359662-191a\",\"type\":\"prompt\",\"dataType\":[\"No\",\"Yes - Female\",\"Yes - Male\"],\"designer\":{\"xLocation\":380,\"yLocation\":60,\"listStyle\":3,\"next\":\"cfd497913114-39e037cecd51d1dd-7361\"},\"text\":\"Do you have any gender preference?\",\"variable\":\"gender\",\"stringId\":\"stringId_3a0fdeaceacf85e1\"},{\"id\":\"5acaee3b9efb-8322543072e1d8c4-dbad\",\"type\":\"statement\",\"designer\":{\"xLocation\":309,\"yLocation\":351},\"text\":\"JSON.stringify(${err});\",\"label\":\"Error handling\",\"stringId\":\"stringId_7f726cd178d669c8\"},{\"id\":\"7f375321d471-9a5124d1f8d2e22f-f54b\",\"type\":\"action\",\"label\":\"Create call parameters action\",\"designer\":{\"xLocation\":380,\"yLocation\":248,\"next\":\"9b6374f51806-7008b402e962d220-ff93\"},\"onInit\":\"/*\\n * Use the following variable notation:\\n * \\n * ${var} = scenario local variables\\n * &{var} = user data variables\\n * @{var} = global conversation variables\\n * \\n * Available object to use in the code:\\n * require, session, moment, builder, next(), setTimeout, underscore\\n * \\n * Hit 'Ctrl + Space' for autocomplete\\n * \\n * Example: ${welcomeMessage} = \\\"Hello \\\" + ${name}\\n*/\\n\\nswitch(${gender}.entity) {\\n    case \\\"No\\\":\\n        ${doctorGender} = \\\"\\\";\\n        break;\\n    case \\\"Yes - Male\\\":\\n        ${doctorGender} = \\\"gender=male\\\";\\n        break;\\n    default:\\n        ${doctorGender} = \\\"gender=female\\\";\\n}\\n\\nswitch(${specialties}.entity) {\\n    case \\\"Cardiology\\\":\\n        ${doctorType} = \\\"Cardiologist\\\";\\n        break;\\n    case \\\"Dermatology\\\":\\n        ${doctorType} = \\\"=Dermatologist\\\";\\n        break;\\n    case \\\"Endocrinology\\\":\\n        ${doctorType} = \\\"Endocrinologist\\\";\\n        break;\\n    case \\\"Pediatrics\\\":\\n        ${doctorType} = \\\"Pediatrician\\\";\\n        break;\\n    default:\\n        ${doctorType} = \\\"Urologist\\\";\\n}\\n\\n/*\\n* In order to use the user's current location as suggested below, you need to host the HealthBot Container\\n* and call chatRequested().\\n* Link to our github repository: https://github.com/Microsoft/HealthBotContainerSample\\n */\\n${mocked_location}=\\\"location=37.773%2C-122.413%2C100\\\";\\nswitch (${location_option}.entity) {\\n    case \\\"Current location\\\":\\n        ${user_location} = @{initConversationEvent} && @{initConversationEvent}.location\\n        ? \\\"location=\\\" +  @{initConversationEvent}.location.lat + \\\"%2C\\\" + @{initConversationEvent}.location.long +\\\"%2C100\\\"\\n        : ${mocked_location};\\n        break;\\n    default:\\n         ${user_location} = ${mocked_location};\\n}\\n\"},{\"id\":\"2966c1e89cd3-48981a677239cb8c-e3b5\",\"type\":\"statement\",\"designer\":{\"xLocation\":440,\"yLocation\":440},\"label\":\"Show Cards\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"Carousel\",\"carouselCode\":\"(function(){\\n    var doctors = [];\\n    for (var i =0 ; i < ${doctors}.data.length; i++) {\\n        doctors.push(new builder.ThumbnailCard().title(${doctors}.data[i].name).subtitle(${doctors}.data[i].specialty).\\n        text(${doctors}.data[i].clinic +\\\"\\\\n\\\" + ${doctors}.data[i].address + \\\"\\\\n\\\" + ${doctors}.data[i].hours).\\n        images([builder.CardImage.create(session,${doctors}.data[i].img)]).\\n        buttons([\\n            builder.CardAction.postBack(session,'schedule','Schedule an appointment'),\\n            builder.CardAction.postBack(session,'call','Call ' + ${doctors}.data[i].phone) \\n        ]));\\n    }\\n    return doctors;\\n    })()\\n\"}]},{\"id\":\"cfd497913114-39e037cecd51d1dd-7361\",\"type\":\"prompt\",\"dataType\":[\"Current location\",\"ZIP code\"],\"designer\":{\"xLocation\":380,\"yLocation\":100,\"listStyle\":3,\"next\":\"1dcef15d1fbb-58ea976331035140-a3f0\"},\"text\":\"Got it! I will be happy to assist. Should I use your current location or would you like to specify a ZIP code?\",\"variable\":\"location_option\",\"stringId\":\"stringId_f9b71f34617f8ffa\"},{\"id\":\"bcca11b7999c-4f437f4bca5dee54-d4a6\",\"type\":\"branch\",\"condition\":\"${doctors}.data.length !== 0\\r\\n\",\"designer\":{\"xLocation\":386,\"yLocation\":369,\"next\":\"8e1bd5dc1861-395f4143d4549e6a-2635\"},\"targetStepId\":\"2966c1e89cd3-48981a677239cb8c-e3b5\"},{\"id\":\"8e1bd5dc1861-395f4143d4549e6a-2635\",\"type\":\"statement\",\"designer\":{\"xLocation\":320,\"yLocation\":440},\"text\":\"No doctors were found that meet all criteria\",\"stringId\":\"stringId_3dbb98f559a4323a\"},{\"id\":\"6eb38059e0f4-354d4b1c3331bfed-9eb5\",\"type\":\"switch\",\"designer\":{\"xLocation\":170,\"yLocation\":140,\"next\":\"695d87603dbd-e563a89769ed22e4-9bd3\"},\"cases\":[{\"value\":\"Hospital\",\"targetStepId\":\"273d9123cd8e-a38fcd49d8611cb4-ed25\"}],\"condition\":\"${doctor_type}.entity\"},{\"id\":\"273d9123cd8e-a38fcd49d8611cb4-ed25\",\"type\":\"statement\",\"designer\":{\"xLocation\":60,\"yLocation\":220,\"next\":\"17980ff39aed-a7a0b09798ec56ed-4b1f\"},\"text\":\"This option is not implemented yet. Please try another one.\",\"stringId\":\"stringId_c76649e46c9d40d4\"},{\"id\":\"cf887de9e443-d47a25d4ea0d4902-328a\",\"type\":\"statement\",\"designer\":{\"xLocation\":320,\"yLocation\":200,\"next\":\"7f375321d471-9a5124d1f8d2e22f-f54b\"},\"text\":\"Developer notice!\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n\\t\\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n\\t\\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n\\t\\\"version\\\": \\\"1.0\\\",\\r\\n\\t\\\"body\\\": [\\r\\n\\t\\t{\\r\\n\\t\\t\\t\\\"type\\\": \\\"Container\\\",\\r\\n\\t\\t\\t\\\"items\\\": [\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"TextBlock\\\",\\r\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"Turn on end-user active location\\\",\\r\\n\\t\\t\\t\\t\\t\\\"weight\\\": \\\"bolder\\\",\\r\\n\\t\\t\\t\\t\\t\\\"size\\\": \\\"medium\\\"\\r\\n                }\\r\\n\\t\\t\\t]\\r\\n\\t\\t},\\r\\n\\t\\t{\\r\\n\\t\\t\\t\\\"type\\\": \\\"Container\\\",\\r\\n\\t\\t\\t\\\"items\\\": [\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\\"type\\\": \\\"TextBlock\\\",\\r\\n\\t\\t\\t\\t\\t\\\"text\\\": \\\"This scenario currently uses a static fixed location for provider lookup, you can turn on end-user active location option only after embedding the health bot instance within your application.\\\",\\r\\n\\t\\t\\t\\t\\t\\\"wrap\\\": true\\r\\n\\t\\t\\t\\t},\\r\\n                {\\r\\n                    \\\"type\\\": \\\"TextBlock\\\",\\r\\n                    \\\"wrap\\\": true,\\r\\n                    \\\"text\\\": \\\"[Embed a health bot instance in your application](https://docs.microsoft.com/en-us/healthbot/integrations/embed)\\\"\\r\\n                },\\r\\n                {\\r\\n                    \\\"type\\\": \\\"TextBlock\\\",\\r\\n                    \\\"wrap\\\": true,\\r\\n                    \\\"text\\\": \\\"[Sending user location while in chat](https://docs.microsoft.com/en-us/healthbot/integrations/embed)\\\"\\r\\n                }\\r\\n\\t\\t\\t]\\r\\n\\t\\t}\\r\\n\\t]\\r\\n}\"}],\"label\":\"Developer notice\",\"stringId\":\"stringId_5770680de9fcb351\"},{\"id\":\"af530ebc0fd1-d4589ef406bd6367-2744\",\"type\":\"prompt\",\"dataType\":\"number\",\"designer\":{\"xLocation\":448,\"yLocation\":200,\"next\":\"7f375321d471-9a5124d1f8d2e22f-f54b\"},\"text\":\"Please enter a ZIP code\",\"variable\":\"zip\",\"stringId\":\"stringId_cf14ebd73bfaddbb\"},{\"id\":\"1dcef15d1fbb-58ea976331035140-a3f0\",\"type\":\"branch\",\"condition\":\"${location_option}.entity === \\\"ZIP code\\\"\",\"designer\":{\"xLocation\":390,\"yLocation\":140,\"next\":\"cf887de9e443-d47a25d4ea0d4902-328a\"},\"targetStepId\":\"af530ebc0fd1-d4589ef406bd6367-2744\"}],\"returningMessage\":\"\",\"interrupting\":false,\"breaking\":false}"}